# 리액트는 어떻게 내부적으로 초기 마운트를 처리하나요?

## Fiber Architecture란?

리액트가 앱 상태의 내부 표현을 유지하는 방법으로 `FiberRootNode`, `FiberNodes`로 이루어져있는 트리 형태의 구조

모든 종류의 FiberNode가 있고 일부 HostComponent ex) <div/> 와 같은 타입은 DOM node를 갖고 있다.

### FiberRootNode란?

- 전체 애플리케이션의 Fiber Tree를 관리하는 곳
- 필요한 메타데이터를 저장 (컨테이너 정보, 에러 핸들러)
- Fiber Tree의 참조: current 프로퍼티의 경우 실제 렌더링된 Fiber Tree를 가르키며 업데이트를 통해 Fiber Node가 재생성 될 때마다 생성된 Node로 재할당됨

### FiberNode란?

FiberRootNode를 제외한 모든 노드로 아래의 중요한 프로퍼티를 갖는다.

- tag: 이 프로퍼티를 통해 많은 서브 타입으로 나눌 수 있음 [react/ReactWorkTags.js](https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactWorkTags.js)
- stateNode: HostComponent는 실제 DOM node, 나머지는 컴포넌트 인스턴스를 의미한다.
- child, sibling, return: 이 프로퍼티들을 통해 트리 구조를 구성할 수 있음. (child 첫 번째 자식 Fiber 노드 참조, sibling 형제 Fiber 노드 참조, return 부모 Fiber 노드 참조)
- elementType: 컴포넌트 함수 혹은 HTML Tag를 의미
- flags: 해당 Fiber Node가 커밋 단계에서 적용 할 업데이트를 표시 (비트마스크를 통해 효율적으로 처리한다네요 [react/ReactFiberWorkLoop](https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactFiberWorkLoop.js)
- lanes: 업데이트 우선 순위와 스케줄링을 관리, 여러 업데이트를 동시에 처리할 때 중요도에 따라 중단 및 재개를 효율적으로 하기 위함
- memoizedState: 마지막 렌더링 시 사용되어 커밋된 props로, 이를 통해 이전 props와 비교하여 변경 여부를 결정 -> 불필요한 업데이트 방지


